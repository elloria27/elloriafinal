<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>eco-curve-interact</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />
    <meta property="og:image" content="/og-image.png" />
    <script>
      // Load initial SEO settings from Supabase Edge Function
      (async () => {
        try {
          console.log('Loading SEO settings for current path...');
          const path = window.location.pathname;
          const response = await fetch('https://euexcsqvsbkxiwdieepu.functions.supabase.co/get-seo-meta?path=' + path, {
            headers: {
              'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV1ZXhjc3F2c2JreGl3ZGllZXB1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc1OTE0ODYsImV4cCI6MjA1MzE2NzQ4Nn0.SA8nsT8fEf2Igd91FNUNFYxT0WQb9qmYblrxxE7eV4U'
            }
          });
          const seoData = await response.json();
          
          if (seoData) {
            console.log('SEO data loaded:', seoData);
            
            // Update basic meta tags
            if (seoData.title) {
              document.title = seoData.title;
              
              // Update og:title
              let ogTitle = document.querySelector('meta[property="og:title"]');
              if (!ogTitle) {
                ogTitle = document.createElement('meta');
                ogTitle.setAttribute('property', 'og:title');
                document.head.appendChild(ogTitle);
              }
              ogTitle.setAttribute('content', seoData.title);
            }
            
            if (seoData.description) {
              document.querySelector('meta[name="description"]').setAttribute('content', seoData.description);
              
              // Update og:description
              let ogDesc = document.querySelector('meta[property="og:description"]');
              if (!ogDesc) {
                ogDesc = document.createElement('meta');
                ogDesc.setAttribute('property', 'og:description');
                document.head.appendChild(ogDesc);
              }
              ogDesc.setAttribute('content', seoData.description);
            }
            
            if (seoData.keywords) {
              let keywords = document.querySelector('meta[name="keywords"]');
              if (!keywords) {
                keywords = document.createElement('meta');
                keywords.setAttribute('name', 'keywords');
                document.head.appendChild(keywords);
              }
              keywords.setAttribute('content', seoData.keywords);
            }
            
            if (seoData.image) {
              let ogImage = document.querySelector('meta[property="og:image"]');
              if (!ogImage) {
                ogImage = document.createElement('meta');
                ogImage.setAttribute('property', 'og:image');
                document.head.appendChild(ogImage);
              }
              ogImage.setAttribute('content', seoData.image);
            }
            
            if (seoData.canonical_url) {
              let canonical = document.querySelector('link[rel="canonical"]');
              if (!canonical) {
                canonical = document.createElement('link');
                canonical.setAttribute('rel', 'canonical');
                document.head.appendChild(canonical);
              }
              canonical.setAttribute('href', seoData.canonical_url);
            }
            
            console.log('SEO tags updated successfully');
          }
        } catch (error) {
          console.error('Error loading SEO settings:', error);
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>